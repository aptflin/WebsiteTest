<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=844, height=390, initial-scale=1.0">
  <title>Round Start</title>
  <link rel="stylesheet" href="src/playing2.css">
</head>

<body>
  <script src="src/BluePlaying.js"></script>
  <div class="container">
    <!-- 左上角光效 -->
    <img src="src/leftlight.png" class="left-light" alt="左光">
    <!-- 左上角色圖 -->
    <img src="src/BlueArea.png" class="character" alt="角色地圖">
    <!-- 中央 Round 標題 -->
    <div class="round-info">
      <h2 class="round-title">ROUND</h2>
      <h1 class="round-number">1</h1>
    </div>
    <!-- 中央箭頭提示 -->
    <img src="src/bigarrow.png" class="arrow" alt="箭頭提示">
    <div>
      <!-- 右下角光效 -->
      <img src="src/rightlight.png" class="right-light" alt="右光">
      <!-- 右下角 GOAL -->
      <img src="src/goal.png" class="goal" alt="終點路徑">
      <h2 class="goal-text">GOAL!</h2>
      <!-- 光球回饋 --> <!-- 新加了這個div class!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! -->
      <div class="color-lights">
        <div class="light-ball white" style="top: 304.5px; left: 585px;"></div>
        <div class="light-ball yellow" style="top: 256.5px; left: 638px;"></div>
        <div class="light-ball magenta" style="top: 220.5px; left: 700px;"></div>
        <div class="light-ball cyan" style="top: 196.5px; left: 765px;"></div>
      </div>
    </div>
  </div>

  <script>
    let ws = new WebSocket('wss://websitetest-xx30.onrender.com');
    const ballCyan = document.querySelectorAll('.light-ball.cyan');
    const ballMagenta = document.querySelectorAll('.light-ball.magenta');
    const ballYellow = document.querySelectorAll('.light-ball.yellow');
    const ballWhite = document.querySelectorAll('.light-ball.white');

    ws.addEventListener('message', (message) => {
      if (message.data == 'ping') {
        ws.send('pong');
        return
      }

      let data = JSON.parse(message.data);
      if ('colorC' in data) {
        let valC = data['colorC'];
        if (valC == 1) {
          //toggleC.checked = true;
          ballCyan.forEach((cyan) => {
            cyan.classList.add('active');
          });
        }
      }
      if ('colorM' in data) {
        let valM = data['colorM'];
        if (valM == 1) {
          //toggleC.checked = true;
          ballMagenta.forEach((magenta) => {
            magenta.classList.add('active');
          });
        }
      }
      if ('colorY' in data) {
        let valY = data['colorY'];
        if (valY == 1) {
          //toggleC.checked = true;
          ballYellow.forEach((yellow) => {
            yellow.classList.add('active');
          });
        }
      }
      if ('colorW' in data) {
        let valW = data['colorW'];
        if (valW == 1) {
          //toggleC.checked = true;
          ballWhite.forEach((white) => {
            white.classList.add('active');
          });
        }
      }
    });
  </script>
</body>

</html>